# --------------------------------------------------
# Profil local par défaut
# --------------------------------------------------
spring:
  application:
    name: discovery-server
  config:
    import: optional:configserver:http://config-server:8888
  profiles:
    active: default

logging:
  level:
    org:
      springframework:
        boot: INFO
        web: INFO

eureka:
  client:
    register-with-eureka: false
    fetch-registry: false
  instance:
    hostname: localhost
    prefer-ip-address: true

management:
  endpoints:
    web:
      exposure:
        include: "*"                    # expose tous les endpoints y compris prometheus
  endpoint:
    health:
      show-details: "always"
    prometheus:
      enabled: true                    # active /actuator/prometheus
  metrics:
    export:
      prometheus:
        enabled: true                  # active l'export des métriques pour Prometheus

server:
  port: 8761

---

# --------------------------------------------------
# Profil docker (Minikube / Kubernetes)
# --------------------------------------------------
spring:
  config:
    activate:
      on-profile: docker
    import: optional:configserver:http://config-server:8888
  # (профиль активируется переменной SPRING_PROFILES_ACTIVE=docker)

eureka:
  client:
    register-with-eureka: false
    fetch-registry: false
  instance:
    hostname: discovery-server
    prefer-ip-address: true

management:
  endpoints:
    web:
      exposure:
        include: "*"                    # expose tous les endpoints y compris prometheus
  endpoint:
    health:
      show-details: "always"
    prometheus:
      enabled: true                    # <— НЕОБХОДИМО: активируем Prometheus endpoint
  metrics:
    export:
      prometheus:
        enabled: true                  # <— НЕОБХОДИМО: включаем экспорт метрик

server:
  port: 8761
